template:
  name: "high-throughput-pipeline"
  description: "High-throughput pipeline with multiple parallel queues"
  version: "1.0"
  type: "pipeline"
  
wants:
  # Generator want
  - metadata:
      name: "{{.targetName}}-generator"
      type: sequence
      labels:
        role: source
        owner: child
        category: producer
    spec:
      params:
        count: "{{.count}}"
        rate: "{{.rate}}"

  # Parallel Queue 1
  - metadata:
      name: "{{.targetName}}-queue-1"
      type: queue
      labels:
        role: processor
        owner: child
        category: parallel-queue
        queue_id: "1"
    spec:
      params:
        service_time: "{{.service_time}}"
      using:
        - category: producer

  # Parallel Queue 2  
  - metadata:
      name: "{{.targetName}}-queue-2"
      type: queue
      labels:
        role: processor
        owner: child
        category: parallel-queue
        queue_id: "2"
    spec:
      params:
        service_time: "{{.service_time}}"
      using:
        - category: producer

  # Parallel Queue 3
  - metadata:
      name: "{{.targetName}}-queue-3"
      type: queue
      labels:
        role: processor
        owner: child
        category: parallel-queue
        queue_id: "3"
    spec:
      params:
        service_time: "{{.service_time}}"
      using:
        - category: producer

  # Sink want
  - metadata:
      name: "{{.targetName}}-sink"
      type: sink
      labels:
        role: collector
        category: display
    spec:
      params:
        display_format: "Processed: %d"
      using:
        - category: parallel-queue

parameters:
  targetName: "high-throughput"
  count: 10000
  rate: 100.0
  service_time: 0.01
  parallel_queues: 3